{% extends 'bookmarker/base.html' %}
{% load static %}
{% block main %}

<section class="top">
    <div>
        <form action="" class="form-input">
            <input id="v" name="v" type="text" class="top-input form-control" placeholder="Paste video Url or id here">
            <button class="btn-d btn-red" id="v_btn" disabled type="submit">
                <i class="fa fa-play" aria-hidden="true"></i>
            </button>
        </form>
    </div>
</section>

<section class="grid">
    <div class="video-grid">

        {% if video.vid %}
        <div class="embed-responsive embed-responsive-16by9 video">
            <div class="embed-responsive-item">
                <div id="player" data-plyr-provider="youtube" data-plyr-embed-id="{{video.vid}}"></div>
            </div>
        </div>
        {% else %}
        <video controls class="video">
            <source src="" type="video/mp4" />
        </video>
        {% endif %}

        <div class="controls">
            <div class="manual-controls">
                <button class="btn-d btn-red-small text-bold">
                    Control Options&nbsp; &nbsp;
                </button>
                <button class="btn-d btn-grey-small mr-5">Auto-Pause</button>
                <button class="btn-d btn-grey-small">Manual</button>
            </div>

            <div class="voice-controls">
                <button class="btn-d btn-blue-small text-bold">
                    Unlock Voice Play
                </button>
                <button class="btn-d btn-grey-small mr-4">
                    <img src="{% static 'images/PauseLock.png' %}" width="30px" alt="" /> Voice
                    Play
                </button>
                <form class="control-form" action="{% url 'activate_voice_pause' %}" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="v" value={{video.vid}}>
                    <button type="submit" class="btn-d btn-grey-small">
                        {% if request.user.voice_pause.has %}<img src="{% static 'images/PauseLock.png' %}" width="30px" alt="" />{% endif %} Voice
                        Pause
                    </button>
                </form>
            </div>
        </div>
    </div>
    <div class="video-description">
        <div class="description-right">
            <div class="head">
                <h5>Video Description</h5>
            </div>
            <div class="description"> {% if video.vid %}{{ description | urlizetrunc:25 | linebreaks}}{% endif %}</div>
        </div>

        <div class="description-right">
            <div class="Pause-times" id="colorGray">
                <h5>Auto Pause Times</h5>
                <div class="custom-control switch custom-switch">
                    <input type="checkbox" class="custom-control-input" id="customSwitches">
                    <label class="custom-control-label switch" for="customSwitches"></label>
                </div>

            </div>

            <div id="stamp_display" class="stamp_display"></div>
        </div>
        <div class="last-btn">
            <button class="btn-success account-btn btn-d last text-medium btn" id="addTimeStamp">Add timestamp</button>
            <form action="" method="post" id="submitTimeStamp">
                {% csrf_token %}
                <textarea id="timestamps" name="timestamps" hidden>{{video.timestamps}}</textarea>
                <button class="btn-success btn-d account-btn btn last text-medium last g-recaptcha"
                    data-sitekey="6LcxrbAZAAAAAGRIVwQ2GaF4dzztHIFm7El9Z9Yo" data-callback="onSubmit"
                    type="submit">Update List</button>
            </form>
        </div>
    </div>
</section>
{% endblock main %}
{% block script %}

<script>
   function play() {
        player.play()
    }

    function pause() {

        player.pause();

    }


    if (annyang) {
        var commands = {
            'play': play,
            'continue': play,
            'resume': play,
            'unpause': play,

            {% if beta %}
                'pause': pause
            {% elif voice_pause == 0 %}

                'pause': pause

            {% elif voice_pause == 1 and request.user.is_authenticated%}

                'pause': pause

            {% elif voice_pause == 2 %}

                {% if request.user.voice_pause.has %}
                
                    'pause': pause
                
                {% endif %}

            {% endif %}
        };

        annyang.addCommands(commands);

        annyang.start({
            autoRestart: true,
            continuous: true
        })

    }
</script>

{% endblock script %}